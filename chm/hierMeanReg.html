<html><head><title>Hierarchical Normal Means Regression Model</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>hierMeanReg(bolstad2)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   hierMeanReg">
<param name="keyword" value=" Hierarchical Normal Means Regression Model">
</object>


<h2>Hierarchical Normal Means Regression Model</h2>


<h3>Description</h3>

<p>
fits a hierarchical normal model of the form <i>E[y_{ij}]
= &mu;_{j} + &beta;_{1}x_{i1}+...+&beta;_{p}x_{ip}</i>
</p>


<h3>Usage</h3>

<pre>
hierMeanReg(design, priorTau, priorPsi, priorVar,
            priorBeta = NULL, steps = 1000, startValue = NULL,
            randomSeed = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>design</code></td>
<td>
a list with elements y = response vector, group  =
grouping vector, x = matrix of covariates or NULL if there are no
covariates</td></tr>
<tr valign="top"><td><code>priorTau</code></td>
<td>
a list with elements tau0 and v0</td></tr>
<tr valign="top"><td><code>priorPsi</code></td>
<td>
a list with elements psi0 and eta0</td></tr>
<tr valign="top"><td><code>priorVar</code></td>
<td>
a list with elements s0 and kappa0</td></tr>
<tr valign="top"><td><code>priorBeta</code></td>
<td>
a list with elements b0 and bMat or NULL if x is
NULL</td></tr>
<tr valign="top"><td><code>steps</code></td>
<td>
the number of Gibbs sampling steps to take</td></tr>
<tr valign="top"><td><code>startValue</code></td>
<td>
a list with possible elements tau, psi, mu, sigmasq
and beta. tau, psi and sigmasq must all be scalars. mu and beta must
be vectors with as many elements as there are groups and covariates
respectively</td></tr>
<tr valign="top"><td><code>randomSeed</code></td>
<td>
a random seed for the random number generator</td></tr>
</table>

<h3>Value</h3>

<p>
A data frame with variables:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>tau</code></td>
<td>
Samples from the posterior distribution of tau</td></tr>
<tr valign="top"><td><code>psi</code></td>
<td>
Samples from the posterior distribution of psi</td></tr>
<tr valign="top"><td><code>mu</code></td>
<td>
Samples from the posterior distribution of mu</td></tr>
<tr valign="top"><td><code>beta</code></td>
<td>
Samples from the posterior distribution of beta if there
are any covariates</td></tr>
<tr valign="top"><td><code>sigmaSq</code></td>
<td>
Samples from the posterior distribution of <i>&sigma;^2</i></td></tr>
<tr valign="top"><td><code>sigma</code></td>
<td>
Samples from the posterior distribution of sigma</td></tr>
</table>

<h3>Examples</h3>

<pre>
priorTau &lt;- list(tau0 = 0, v0 = 1000)
priorPsi &lt;- list(psi0 = 500, eta0 = 1)
priorVar &lt;- list(s0 = 500, kappa0 = 1)
priorBeta &lt;- list(b0 = c(0,0), bMat = matrix(c(1000,100,100,1000), nc = 2))

data(hiermeanRegTest.df)
data.df &lt;- hiermeanRegTest.df
design &lt;- list(y = data.df$y, group = data.df$group,
               x = as.matrix(data.df[,3:4]))
r&lt;-hierMeanReg(design, priorTau, priorPsi, priorVar, priorBeta)

oldPar &lt;- par(mfrow = c(3,3))
plot(density(r$tau))
plot(density(r$psi))
plot(density(r$mu.1))
plot(density(r$mu.2))
plot(density(r$mu.3))
plot(density(r$beta.1))
plot(density(r$beta.2))
plot(density(r$sigmaSq))
par(oldPar)

## example with no covariates
priorTau &lt;- list(tau0 = 0, v0 = 1000)
priorPsi &lt;- list(psi0 = 500, eta0 = 1)
priorVar &lt;- list(s0 = 500, kappa0 = 1)

data(hiermeanRegTest.df)
data.df &lt;- hiermeanRegTest.df
design &lt;- list(y = data.df$y, group = data.df$group, x = NULL)
r&lt;-hierMeanReg(design, priorTau, priorPsi, priorVar)

oldPar &lt;- par(mfrow = c(3,2))
plot(density(r$tau))
plot(density(r$psi))
plot(density(r$mu.1))
plot(density(r$mu.2))
plot(density(r$mu.3))
plot(density(r$sigmaSq))
par(oldPar)

</pre>



<hr><div align="center">[Package <em>bolstad2</em> version 1.0-12 <a href="00Index.html">Index</a>]</div>

</body></html>
